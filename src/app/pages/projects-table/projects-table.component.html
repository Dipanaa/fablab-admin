@if(notificationStatusService.statusMessage()){
<status-message></status-message>
} @if(openDeleteView()){
<modal-component
  [show]="openDeleteView()"
  [title]="'¿Esta seguro que desea eliminar este proyecto?'"
  [description]="
    'El o los usuarios participes del proyecto ya no tendran mas acceso a el'
  "
  (close)="openDeleteView.set(false)"
  (decline)="openDeleteView.set(false)"
  (accept)="deleteProject()"
></modal-component>
}

<div class="border-slate-800 flex flex-col gap-3">
  <div
    class="flex flex-col md:flex-row md:items-center md:justify-between gap-4"
  >
    <h1 class="text-3xl font-bold text-white">Administración de Proyectos</h1>
    <!-- Controles: buscador + filtros -->
    <div
      class="flex flex-col md:flex-row items-stretch md:items-center gap-3 w-full md:w-auto"
    >
      <!-- Buscador -->
      <searcher></searcher>
    </div>
  </div>

  <div class="h-auto w-full overflow-auto rounded-lg border border-slate-800">
    <table class="min-w-full text-sm text-left text-gray-300">
      <thead class="text-xs uppercase bg-slate-800 text-gray-400 sticky top-0">
        <tr>
          <th class="px-6 py-3 font-bold">Proyecto</th>
          <th class="px-6 py-3 font-bold">Fecha</th>
          <th class="px-6 py-3 font-bold">Descripción</th>
          <th class="px-6 py-3 font-bold">Categoría</th>
          <th class="px-6 py-3 font-bold">Integrantes</th>
          <th class="px-6 py-3 font-bold">Acciones</th>
        </tr>
      </thead>
      <tbody class="divide-y divide-slate-800">
        <tr
          *ngFor="let proyecto of projectsService.projectsData()"
          class="bg-gray-900 hover:bg-slate-800/60 transition"
        >
          <td class="px-6 py-4">
            <div class="flex items-center h-16">
              <img
                class="h-12 w-12 rounded object-cover flex-shrink-0 border border-slate-700"
                [src]="proyecto.imgurl"
                alt="Imagen del proyecto"
              />
              <div class="ml-4 max-w-[12rem]">
                <div
                  class="text-sm font-medium text-white line-clamp-2"
                  title="{{ proyecto.titulo }}"
                >
                  {{ proyecto.titulo }}
                </div>
              </div>
            </div>
          </td>

          <td class="px-6 py-4 text-gray-400 whitespace-nowrap">
            {{ proyecto.fechainicio }}
          </td>

          <td class="px-6 py-4 align-top">
            <div
              class="max-h-[3.5rem] overflow-y-auto text-sm text-gray-400 pr-2"
            >
              {{ proyecto.descripcionproyecto }}
            </div>
          </td>

          <td class="px-6 py-4 text-gray-400">
            <span
              class="text-indigo-300 text-xs font-semibold px-2 py-1 rounded-full"
            >
              {{ proyecto.categoria }}
            </span>
          </td>

          <td class="px-6 py-4 align-top">
            <div class="max-h-[4rem] overflow-y-auto text-gray-400">
              <ol class="list-decimal list-inside text-sm">
                <li class="text-gray-500 italic">Lista de integrantes...</li>
              </ol>
            </div>
          </td>

          <td class="px-4 py-4 whitespace-nowrap text-sm font-medium space-x-3">
            <a
              class="bg-indigo-600 text-gray-200 px-3 py-1 rounded hover:bg-indigo-700 cursor-pointer"
            >
              Editar
            </a>
            <a
              (click)="modalDeleteView(proyecto.id)"
              class="bg-red-600 text-gray-200 px-3 py-1 rounded hover:bg-red-700 cursor-pointer"
            >
              Eliminar
            </a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Paginación -->
  <!-- Aqui conectamos el componente <pagination> con el paginationService
       enviando los 3 parametros que necesita y dejando activo el event a la espera de algun cambio-->
  <pagination
    [currentPage]="paginationService.currentPage()"
    [totalPages]="paginationService.totalPages()"
    (pageChange)="paginationService.goToPage($event)"
  />
</div>
